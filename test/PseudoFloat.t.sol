// SPDX-License-Identifier: Unlicense
pragma solidity ^0.8.20;

import "forge-std/Test.sol";
import {PseudoFloat} from "../src/PseudoFloat.sol";

contract PseudoFloatTest is Test {
    function test_0_is_0x00() public {
        checkEqual(0, hex"00");
    }

    function test_pt0123_ETH_is_0x7b0f() public {
        checkEqual(12_300_000 gwei, hex"7b0f");
    }

    function test_pt883887085_ETH_is_0x55b4d7c27d() public {
        checkEqual(883_887_085 gwei, hex"55b4d7c27d");
    }

    function test_123x10pow_n() public {
        uint256 value = 123;

        while (true) {
            checkEncodeAndDecode(value);

            if (type(uint256).max / value < 10) {
                break;
            }

            value *= 10;
        }
    }

    function test_10_pow_77() public {
        checkEncodeAndDecode(10 ** 77);
    }

    function test_max_uint256() public {
        checkEncodeAndDecode(type(uint256).max);
    }

    function test_tx_values_from_20_blocks() public {
        bytes memory rlpTxValues =
            // Including these leading bytes would create a valid RLP array of
            // all the tx.values. We avoid including the code to interpret
            // these and instead just stop when we run out of bytes.
            //     hex"f925d6" 
            hex"870a1d40bbff073682b0068704229bc64a50dd88010e0198eaee00"
            hex"0087c994bab88e400088120a871cc002000088013e2d45b49a680088021d"
            hex"84798d7aa800876bacaa5051dc0088019ffc683f1410008603b3cb0fa4bc"
            hex"8603be095cbdca87470de4df8200008801aa535d3d0c00008751007aace1"
            hex"00008740cd2ef0b40000880123cff523f50c0087eafe86ecab100088136b"
            hex"bd135793c00087a7b02661660000876a94d74f4300008801936ae92fd50f"
            hex"d087470de4df8200008758d15e1762800088063eb89da4ed000087670758"
            hex"aa7c800087ae153d89fe80008707d0e36a81800088011c37937e08000087"
            hex"24568d2810178f875644b7c0a9f01087ae153d89fe800087dc44abe81300"
            hex"00875543df729c0000870590c4b1d13040877fe5cf2bea000087557c95fe"
            hex"3d0a9b880186cc6acd4b00008719396991e7c00088013bd51fe731510087"
            hex"98d6758217bcc887e540d692fd6800890c77e4256863d8000087470de4df"
            hex"82000087470de4df82000087dfd22a8cd9800087982cd1740208088715d1"
            hex"41218fbf558803782dace9d90000880429d069189e000088021f567b515e"
            hex"800088013fbe85edc900008801621a7b4e1ab160876a00d5c0dadf438331"
            hex"dc65880429d069189e0000833558fd8703ea0048a75b1282b50488018de7"
            hex"6816d80000880426dfaad05e6c0087d08b56c850c00087e35fa931a00000"
            hex"8751ca0cee4cec00880214e8348c4f000088016345785d8a0000870a15e3"
            hex"bec7dd8488154b96e763c997c0877fe5cf2bea00008803782dace9d90000"
            hex"87b1a2bc2ec500008904e0fbf7c4136d0000880199ec80018328008904b2"
            hex"6dde93c5fdd0ed88019d3c6507b274008801cc6e836ae4000088019174e6"
            hex"bb9e8000882f53f7957d3a195a8707d0e36a81800087f8b0a10e47000087"
            hex"0100ce7d8a443488136dcc951d8c000087ba2b4a048462de87180887928e"
            hex"719587b5303ad38b800088016345785d8a000087180887928e7195871550"
            hex"f7dca70000873a84f40db5e00c8802c68af0bb140000872386f26fc10000"
            hex"8805f916850754000088044739bb8841ee988704a8688647665787b0f876"
            hex"d0fd156d83410d9e8801aa535d3d0c00008802c68af0bb1400008345ab15"
            hex"8603af8205f5158801cdda4faccd00008603e82a0d90fa82a70482050488"
            hex"02c68af0bb14000087470de4df820000870678e465868b108706935b2455"
            hex"7b108751a7d040a02f58880184183c20307ec48729297ccac92400880646"
            hex"e08f1ab9228487234e47c27fe5bc880ea62d68d0bddfb08801063112a248"
            hex"200087552707f2bcb91d872386f26fc10000871b094132bda000875967f4"
            hex"067306458803bf3b91c95b000088011fc51222ce800087a809b0e62f4c8d"
            hex"8830927f74c9de000087132f4579c98000876a94d74f430000871c6bf526"
            hex"3400008707d0e36a818000871b5b1bf4c540008735cfec17b87b708801aa"
            hex"535d3d0c0000880713e24c4373000087d529ae9e86000087a200f559c200"
            hex"00880429d069189e0000881c01604ee4bd0000870942d79f01f7878711c3"
            hex"7937e0800087b1a2bc2ec5000087f8b0a10e47000088063eb89da4ed0000"
            hex"87b5303ad38b8000886e794fd07f2d291a8802b300b830d04000871ee491"
            hex"510e2a1d873ff2e795f50000881bc16d674ec800008829a2241af62c0000"
            hex"88016345785d8a000088019c09029f9123808705d7b6d56b491d87077de6"
            hex"73ecbb9487868bbe764dc12688016345785d8a000088027f7d0bdb920000"
            hex"88013fbe85edc900008701579637a959b888016345785d8a0000878ecbc7"
            hex"a501eb5088035834391ede800087e526688403400087e526688403400087"
            hex"e526688403400087e63741b5720000872846082d2c80008740cd2ef0b400"
            hex"008803782dace9d900008807aa9455ace3104088013b1ec6ae987aa88369"
            hex"da24836dea148802c68af0bb140000870a5caa60bd3e9687b1a2bc2ec500"
            hex"0088023241283b9db06087b1a2bc2ec5000087b1a2bc2ec5000087b1a2bc"
            hex"2ec50000865af3107a400087b1a2bc2ec5000088012dfb0cb5e88000880d"
            hex"7a7cba64ea99b08801efd8ca11c9f7e88705fdf459ee094887b1a2bc2ec5"
            hex"0000870360a817c9b800870360a817c9b8008801e2839ba83045cf87c109"
            hex"d97031780087d4601fcaf9a4b088018e072b7720688b87470de4df820000"
            hex"87cc47f20295c0008780c7eddff0afbe876a94d74f4300008801cdda4fac"
            hex"cd00008815f96b66219001d0880194c8dd0ce36c1c8802d84e69f2f48000"
            hex"87d4cea44594d80088077e772392b6000087025b651454c4be8707d0e36a"
            hex"8180008802fbd55c62b58000880de0b6b3a76400008731bced02db000087"
            hex"f8b0a10e4700008810e44ac2d7b5c000872386f26fc10000880195026560"
            hex"65000087a59ee710c7a34b87138a388a43e338890107ad8f556c6c000087"
            hex"51b660cdd58000873da194b0e6af8f8801ddd709924a4000873c6568f12e"
            hex"80008751b660cdd5800087f8b0a10e470000876a94d74f43000087354a6b"
            hex"a7a180008712795f58d50000877c58508723800087470de4df8200008803"
            hex"1126543f5c800088016345785d8a000087f0631f499afd0a830b8a7a8804"
            hex"29d069189e0000830c460d870a200f559c20008704907ac3125b158802c6"
            hex"8af0bb140000871b314439129a988758d15e1762800087046aacba569c00"
            hex"87121e6c485ac000881a5a5a92c3dda76388016345785d8a000087d8dc36"
            hex"206f2000870ae9e7fd96b852872386f26fc10000880ddf5055e4337fd088"
            hex"1bafea3ec90cd29c8801a28279d28a8000875e9bd80a5e6000881582b4c9"
            hex"a9db0000883cc3630f46ef480087e337ff7310fc00870422e199ca4a8087"
            hex"0422e199ca4a808722f7aa4c041800870422e199ca4a808808c2bf28dc3e"
            hex"f000880214e8348c4f000087d9270dc2a714008704229b0d95348087d529"
            hex"ae9e86000088221c0a46e3ac9ea1876a94d74f43000088023b9fa3e27abd"
            hex"2d88058d15e1762800008806f05b59d3b200008804fefa17b72400008707"
            hex"d0e36a81800087cf58995ea1428887a200f559c2000087498a8a52d9c000"
            hex"874c6222d6abc00087240ccb5bd5aa5f88015fb7e2704c9800877c585087"
            hex"23800087044364c5bb000088011c37937e08000087ecf47a281ea8008802"
            hex"14e8348c4f00008792e8b594ac8b8c8716b33511bef40086cf081258af90"
            hex"881158e460913d0000880bcbce7f1b15000087f8b0a10e470000873a8072"
            hex"7cd9d6d4880650a6fb126e2ac08818fae27693b40000871672b45489256e"
            hex"8731bced02db00008784f38d03af964987059003dfe68cc88804db732547"
            hex"630000880429d069189e0000870ebe79cc3080008803f374faafbe3f0088"
            hex"0279210d016c2000881ab95aa990a06000880165b905826f20008808a2c8"
            hex"5ceed480008788a41362b4d000880dd8efb1fd67638a8811a0839022bfbc"
            hex"00882aa1173ca067740087ae153d89fe80008829e931ffd5ae0000882e5b"
            hex"2126ff3cc00087045cdc07c8c0008727ca57357c000087470de4df820000"
            hex"87209dbbfdf6dc0088061b8ef6f9a208008905a9e389b70f52c000881e43"
            hex"60bacd2e500087369310accb86f58798ca7e055a4e5788019d7915d1a498"
            hex"0088034e6686ede3e00087b1a2bc2ec50000880280a0b8a52658008818cd"
            hex"ccb3dc1c280088066fb94b5e67d80087470de4df820000880162dfe10504"
            hex"af68880428a40f57413bb58904e0fad4ac64c9a72d87fcb8714bddee7a87"
            hex"fb5d55fee107498807a9a5cde44e556687fd2ae92851ec008801cee802c2"
            hex"fc429888013efa0c880a3330880153c54e35f4dc6888044df2f8db179800"
            hex"88029a41408dae00008829a0a27bb2617d1d880147c98ba0cf73f687fdc5"
            hex"a90791cac087fbb7e195de726a88012a60d9ec1498b087fc42722e674c80"
            hex"87fd010e4a91440088028cf46bdd7d409887fd0e5ff4ec40b387fb8ad9bc"
            hex"932adb89b444990fd4b63c2800880470de4df8200000880f42a70b4d2cb2"
            hex"20880153bdedad3dd61c878200627e6924008738f5311debec0087b1a2bc"
            hex"2ec5000088055008c28c7a60008804fefa17b72400008801c29d16403a58"
            hex"1087b1a2bc2ec5000087470de4df820000870c1448303c800087071afd49"
            hex"8d00008707d0e36a81800087a0f01c28534000890c6a036eb4bc74000087"
            hex"a6fa40407180008802c68af0bb140000880de0b6b3a7640000872fed1562"
            hex"052000871ae7a275486bad872386f26fc100008801988fe4052b8000872e"
            hex"2f6e5e14800087e5dc4ea4f7c000875753a518a8e22e870d1c091338a000"
            hex"8715d233085c307987f8b0a10e47000087154b813c4d585088011c37937e"
            hex"08000087b1a2bc2ec50000880443ba0e080dde668807abd369f80288f887"
            hex"468ebf3c0f7e5a8803e2c284391c00008702a106ad22400087b1a2bc2ec5"
            hex"000088250a315be984800087ed400e6219c0008803d239ac0075f8588801"
            hex"65c21dd0e1c0008802c68af0bb140000871ff973cafa8000879701b2a34c"
            hex"d890870a9679e25c1000872ba269f721a000870aa87bee53800087e304b6"
            hex"2125c000880106fe1bf966600087068c32dbe6b8168806f08882108e9d97"
            hex"8778ef68a938fc00872f73cb2fdb4f5088012dfb0cb5e880008802c68af0"
            hex"bb1400008807a1fe160277000087333b1ff79e73688802a5c6d0d29b4e82"
            hex"88096eaa6f2449222087d529ae9e86000088051da3139b985657880d9a5d"
            hex"c72e669a688807c4ff20ca5e540088154b96e763c997c08802231e2f1f69"
            hex"000087d766a9ecbb600087f4f1c2476daec087e1e65de301dd1f87f8b0a1"
            hex"0e470000871661d10e15c0008806096e31fd4b8000875749e5383e864f88"
            hex"03311fc80a570000870aa87bee538000873161f9f260c00088011c37937e"
            hex"080000871f438daa06000088018a59e97211800088044972afe537ff4587"
            hex"2386f26fc10000880b1a2bc2ec500000879dbd90940700008801b47e8495"
            hex"bfa46887753d533d968000876a94d74f430000870ffcb9e57d4000880f43"
            hex"fc2c04ee0000872bb2c8eabcc0008829a2241af62c00008725a8a4d29e80"
            hex"0087b1a2bc2ec5000087354a6ba7a1800088013fbe85edc9000089015732"
            hex"9bf98f6900008853444835ec580000872c68af0bb140008273058818f9b8"
            hex"955d3c0fd88801e068812d68e350878e1bc9bf040000875db10acadd602e"
            hex"86036c0b4dcdcc8802c68af0bb14000086038adfc64d3b858f1589e00f88"
            hex"02c68af0bb14000085a0fc2406f88802715a8587d20c008802c68af0bb14"
            hex"000087525b22abb9d234880196c924b2c840008805ba3476a2cdc0008861"
            hex"24fee993bc000087aca971481580008845572247043d4000877e588abf13"
            hex"800087da475abf00000088068fb000035b600088076598ad11488000878e"
            hex"1bc9bf0400008801bfa45519b300008812bb52a141f968728718838370f3"
            hex"4000871550f7dca70000872386f26fc1000087016bcc41e9000087b58b2d"
            hex"e405c000880146d9833756000087a200f559c2000087b1a2bc2ec5000087"
            hex"adba4a79844000871c9a5e6155f1ac876ff5f7e474ef18872f24fea42b60"
            hex"0088027f7d0bdb920000871ff973cafa80008804fefa17b72400008711c3"
            hex"7937e0800087dc5ff4d36ae0008722e9ed8d734bd58733b9a18746587887"
            hex"044364c5bb000088016345785d8a00008802c68af0bb1400008801634578"
            hex"5d8a0000871143d1980e0a6087354a6ba7a1800087239a108963180087a8"
            hex"77a3aa55fc0101880533702e777dc440834f4ceb8801aa535d3d0c000083"
            hex"50b6a782740082af00876a94d74f4300008738d7ea4c680000873ff2e795"
            hex"f500008801c97289ad47800087778366da3e800088041b91563711600088"
            hex"019c1d62a9f20000880120c3bab75800008804085defb0318800883aaf21"
            hex"ccc897ddd08726b97e040d400087cf8d86bc1914008703207b6359608088"
            hex"013fbe85edc9000088019e5ebde27ec40087af5a80c31aec0087068babd5"
            hex"a0880088016345785d8a000088039bb49f599a000088016345785d8a0000"
            hex"876d22ec4cf75c878806c26b959abfe0008810a741a4627800008802a303"
            hex"fe4b53000086f9756f764c4186f94f39cd3e588804968de59e3af0008761"
            hex"25a099b0f5c0880853a0d2313c0000872251fff8c134208802c68af0bb14"
            hex"0000880214e8348c4f0000883782dace9d9000008802c68af0bb14000088"
            hex"011c37937e08000088010a741a4627800087b1a2bc2ec5000088086ef0ce"
            hex"3a3c986f876a94d74f4300008721ff6c155e4fbd878e1bc9bf0400008903"
            hex"40aad21b3b700000871606ddfd9b800088295b163616aa0000872ba269f7"
            hex"21a0008804433881305dde9c8705de8962844f5c870c0443c94738ca870b"
            hex"5e620f4800008802386f26fc1000008803d5dedea5dd400088058410a3fa"
            hex"2a94a583fb5b1a8379457188016345785d8a0000837adadd826804880f43"
            hex"fc2c04ee00008701bb54fdf2cffb870381828d9df0fe87ae153d89fe8000"
            hex"88039cd7add005c800876a92b8f520987c88028dbc878335b40087f46d3c"
            hex"488c0000873bf0e7562f9800870ae9664a255f3e87b1a2bc2ec50000870e"
            hex"35fa931a00008814d1120d7b160000872e2f6e5e1480008801cd24698bd8"
            hex"8000877c585087238000870c6f3b40b6c00087470de4df8200008718de76"
            hex"816d800087b1a2bc2ec50000880de0b6b3a76400008803bf3b91c95b0000"
            hex"8709f295cd5f000088020324bb546e8000880237b940db1b800088016345"
            hex"785d8a000088016345785d8a000087470de4df820000870487224a84935e"
            hex"871c6bf526340000872386f26fc1000087051e564dcb125f8801143fb475"
            hex"38671e875da5da5618a40087010884f37406008801c3a6c1d4d45404832a"
            hex"04268806f05b59d3b20000832e08268802c68af0bb14000083fb5b1b870c"
            hex"0e8c20457a3f8288068703b0daef8d77a38806f05b59d3b20000871e8da7"
            hex"89118000871c8aae2291712687dabbde5f9a5e2887121e6c485ac000872b"
            hex"6563077788008802c9cbdfb0db38008738c4477c20240088029ec64b0aab"
            hex"880088027f7d0bdb920000872b9cdaf06a0f8d88016345785d8a00008715"
            hex"cfffefbf7050873dd13533178000878964676019da60890c5c22b8011510"
            hex"0000880214e8348c4f0000880713e24c4373000088162c9b100221365487"
            hex"11c37937e0800088010a7f6a545051748751b660cdd5800088016345785d"
            hex"8a0000876e2255f409800088012dfb0cb5e880008905bf0ba6634f680000"
            hex"8808be35a9807f000087e5dc4ea4f7c00088061b31ab352c0000873ff2e7"
            hex"95f5000087354a6ba7a1800088011c37937e080000876a94d74f43000087"
            hex"3099e3348700008718de76816d800087da2c620173642c88015985c7c416"
            hex"f00082b4068802fc26a495696432892ebaa730eda2b8000083fb5b1c8802"
            hex"14e8348c4f000083fb5b1c860c051aa407418806f05b59d3b20000860c68"
            hex"27800c51880b1a2bc2ec5000008805e863e500e24000860b209605dadd87"
            hex"024439e58886ad8701fd66eac8d8c88805cfd3934e8900008805e73df6cb"
            hex"c908008806d087062e51080087974689ffd63000872fcfc9e8696c008712"
            hex"9e8e9c1d38fb8702c8e8ff9f020087f0321d74442019878e1bc9bf040000"
            hex"872386f26fc100008812091ef3d0ad40008766ac659a02400088044d575b"
            hex"885f000088016345785d8a000087b1a2bc2ec5000087b1a2bc2ec5000087"
            hex"b1a2bc2ec5000087b1a2bc2ec5000087d4464ef554600088015c2a7b13fd"
            hex"00008802386f26fc1000008718de76816d8000880eb5e06245ea0000871f"
            hex"f973cafa800087d4071f617f62d0880429d069189e00008711c37937e080"
            hex"00872386f26fc100008898a7d9b8314c00008801118f178fb48000876a94"
            hex"d74f430000877da961d8a6fc42870c6f3b40b6c0008712c4e73e94d9cb87"
            hex"417b13aa14a7608706e75481ba40008801664f372978e80087b1a2bc2ec5"
            hex"0000878e1bc9bf040000880aa0f45e97dd488587d8883c83b23e5c88012f"
            hex"eed34366c55a87517dea9681efc9872386f26fc10000880213800b9cfa40"
            hex"00876a94d74f430000880103591cfc9a800087e526688403400088054440"
            hex"8bdfbb3a318768b22c1647880087d5c2fee17e4400880138a388a43c0000"
            hex"8805bd904cb9f9700087470de4df820000880267b6bcdfafca00876a94d7"
            hex"4f430000873a9ea99ecb400088016345785d8a0000879d6298db74f80088"
            hex"01e3ebe71ee3ab34870c6f3b40b6c00087519abcf34a3166870405a64788"
            hex"1a318703d7b8fd6c74498703d89d2ac313418703d89d2ac313418703ddd9"
            hex"bc9b7dc18703e0e52848ba998703d89d2ac31341880cd2c8c6c7d2543287"
            hex"03e558780a19b18802ea11e32ad500008803782dace9d900008711c37937"
            hex"e0800087f46d3c488c000087255e5c51db83888802c68af0bb1400008801"
            hex"7508f1956a800087167351fc47b6128801fc09be0ae180008718017f965c"
            hex"6bc1872386f26fc10000870650de2e292bc9880b31f1f2025c1c008722e6"
            hex"e03e460000880890f2095aa214c888081b0d335d920cc888c91ca9f56a2e"
            hex"2ccf873b4fa1acebc53f840260c0e48402738f57835387a088016345785d"
            hex"8a000083546f2e87feac8705a88800878e1bc9bf040000880142805d2280"
            hex"a00083fb5b1e88016345785d8a000083fb5b1e87a78df2b8f869e38801ca"
            hex"34ce4d67400088046bff6328235000870e0f7720d05c0087470de4df8200"
            hex"00876a94d74f43000088052345c117835400880105fe1f7614d80087b1a2"
            hex"bc2ec5000087b73b24ce0efc00882a9e9cd3f07ccc008801b48822206b14"
            hex"00871bfc55d8265c008726ca6fa6957c0087da315ce6b078008758d15e17"
            hex"6280008764bdee90c8a400878e1bc9bf040000876c170fee1b923f87bccb"
            hex"bb1567080087574b32512af9ec87cadf032b4e4c008801c8be75359d2000"
            hex"87463a37de7b9800871acd25ca14767c88016345785d8a0000880214e834"
            hex"8c4f00008802c68af0bb140000881f399b1438a10000870419e3a92313e9"
            hex"8791a94863ca80008758d15e1762800088029be90101c600008702dbddc3"
            hex"2b39f5871550f7dca7000087753d533d96800087b1a2bc2ec500008703e2"
            hex"4324884d11880ca485ac5e61800088010a741a4627800087b1a2bc2ec500"
            hex"0087027ca57357c00087305120c0f200008709e217b4f92457876a94d74f"
            hex"43000087047aef9353b0f18779ecfc3cc27fba871e8c57c526979488011c"
            hex"37937e0800008806fc8a412fd9b4c888080772fd2059abcb8806ef2575a9"
            hex"0c14c887022eb88560e000871f9e80ba80400087b1a2bc2ec500008769fd"
            hex"794e3b5400876540995819400088058d15e176280000870151a2dd0a8e58"
            hex"868cc8cbbd2718870120997d5c74d8870122f15b5e5068880254eb6ac98b"
            hex"e40088060428eea0726cf288025136d946724c8687134ca2f322d47b870c"
            hex"0443c94738ca880230cf29a6cead63882b05699353b60000821e068802c6"
            hex"8af0bb140000865af3107a40008804e7cc54b782e00082069887b1a2bc2e"
            hex"c500008803d1792daafd379e880a6587720ee4f8a08803d0e1e204bc5858"
            hex"8801a9875ef15fe2ce8721a12b68dcc48087123e61743c40c487272c3bee"
            hex"09600087038d7ea4c68000877e7a02ea010000880c58adeab6699c008801"
            hex"c9a85eec341c00880dd68163f03b832888018a8788fdde4c8b8814d1120d"
            hex"7b1600008809f80ff8927e54a4879009abfad5bdec87470de4df82000087"
            hex"da3bfdcaeb70ce872386f26fc10000888c2a687ce7720000884db7325476"
            hex"300000872386f26fc10000871be28ed71ea61d871aa535d3d0c00087470d"
            hex"e4df820000870aa87bee5380008736a5af0d195800880de0b6b3a7640000"
            hex"87dfd22a8cd98000872bb2c8eabcc000881c7310237d8d000087e3c99a97"
            hex"0ac5788801724634310ecffb87d529ae9e860000880221a0b8bb67309988"
            hex"011c9cb89693a4008708e1bc9bf0400087d7e2fddfac38008759c3f6ccb0"
            hex"d32a874a340650678c00880429d069189e000088077551be70106712857e"
            hex"287bc0388803782dace9d90000858b66806e4b88016345785d8a00008644"
            hex"b7c68558c687cfc02f26fbcd5087c70b69a22ba34888016345785d8a0000"
            hex"8805b8bb3f167f5de088030d98d59a96000088030d98d59a96000088030d"
            hex"98d59a96000087670758aa7c800088016345785d8a000087c9149bde3f04"
            hex"0087ae153d89fe800087b1a2bc2ec500008802c2478bf559000087275933"
            hex"13aca0008740c5faebeaa00087a1771fddd794008801e17dda3860400087"
            hex"73aa0911f28b2187e982c032b95c8a886f05b59d3b20000087710a97ecf3"
            hex"20008726dad0ee3c8000880148a04289b94000873b3c35a991a0de8809b6"
            hex"e64a8ec600008806f05b59d3b20000876a94d74f43000087470de4df8200"
            hex"008802c68af0bb14000087353f531ef6f00088011c37937e080000870111"
            hex"7c811a71c288044d575b885f000087202f1ccd053000870aa87bee538000"
            hex"87532a5c898c100087e69234c5ec40008901881158aa9f1996d7876d0864"
            hex"742820008708e1bc9bf04000870375c45e4f1f79878394b45cb5e8f98770"
            hex"409fc7a4ad69872386f26fc10000881c8bee99fefa80008829a2241af62c"
            hex"00008801ba46dd2d7f994f88026f0a70c8125c008801ca6ff5a82d73fd88"
            hex"03d4009fb8d838c888051c32a739651ae888086c5fe0a750c06f88042b28"
            hex"3854af0c5687c6f3b40b6c000087f939b9f26e480087a3fb539e21f33f88"
            hex"077e772392b6000082080d856f48b89340880429d069189e0000857295d0"
            hex"0000880429d069189e000087b1a2bc2ec500008801b477fb95d6e19c8279"
            hex"0488027cb4436246e68888057edfe6e30e00008721143131bfa58087100e"
            hex"ea826280008802c68af0bb14000087eadca295d40bc08801b3fe4cb8c1d2"
            hex"9e875d324adfee5c008808c15b568712040088023a3bcfb4a42800880214"
            hex"e8348c4f000088013fbe85edc900008801ca697a00dece5b871e96bfd784"
            hex"20008802c68af0bb140000881bc028b6c498b000881e420c942408f00087"
            hex"45b9be365ca000878e1bc9bf04000087b1a2bc2ec50000870ae9664a255f"
            hex"3e874ab77dfbce88008806d1dfee575b867087b1a2bc2ec5000087cf5297"
            hex"80c6118e8801b477fb95d6e19c87470de4df8200008801793a25be404000"
            hex"880125195019f84000872386f26fc1000088016345785d8a0000870c6f3b"
            hex"40b6c00088016345785d8a00008722572c91ea4e5588010c8c1193e5681c"
            hex"880278d8bc980aae2d878e1bc9bf040000890c4e42014d6dac00008806f0"
            hex"5b59d3b20000878700cc7577000087498a8a52d9c000871f9e80ba804000"
            hex"872386f26fc10000880de0b6b3a764000087ed24c576c1e0008804b0359c"
            hex"32a56c168801635985ec088cef880173b8b22fce489887470de4df820000"
            hex"87a3aeb1f502c4488802c68af0bb140000870221b262dd800089077dc368"
            hex"3c72d02000880429d069189e00008824b4f6923a41d76888051787d77881"
            hex"86bb88042a06676f2d9fa087a4f78ef76f5467880121ae7c4682c9c28609"
            hex"e6786b6bd38609efd7a8dbab88021f49ef7e41e1278802c68af0bb140000"
            hex"880122f6e0a43fd07887ae153d89fe80008806ef068e5c7092c087b1a2bc"
            hex"2ec500008807787efa8a6b84008711270a58f9c000870645e0692fe00088"
            hex"02a40c017b5700f68758d15e176280008801cdda4faccd0000872aa1efb9"
            hex"4e0000879982da78799099872386f26fc1000088013fbe85edc900008761"
            hex"b31ab352c00088029ec9346d9ef988872386f26fc10000880b19d0cfdbd5"
            hex"c000880214e8348c4f000088013fbe85edc9000088058d15e17628000088"
            hex"025bf6196bd10000871ff973cafa80008716b51e037ffc00880429d06918"
            hex"9e00008803e2c284391c000087af9746059a110f87fbf47beb009960881b"
            hex"4e7d7cb0ea9d0387470de4df8200008801b4736c92a8200087fc3e1fb30d"
            hex"800087c4a78a7ac3e6ad870c0443c94738ca8801bc16d674ec800088113f"
            hex"a2d8e84ca9008775fd770992376e879fdf42f6e4800088183ca64f3bd716"
            hex"738802fef288d0652a28872f5dd656123c488805a09087648aa1488703cb"
            hex"6e6915a800870a9fc0c1bc8000870a963408f75800870aa74d4049b80087"
            hex"66f08a7177ad27832a9bb78806f05b59d3b20000832dd38687716712253b"
            hex"000087716712253b00008801f161421c8e0000880342e341423780008801"
            hex"6345785d8a000088082bd67afbc0000088b72fd2103b2800008802ba7ea8"
            hex"3775c2aa87817f14f6102000870fd239236d6300878e1bc9bf04000087bd"
            hex"75a22d17cc008801b2e3f25e8834008801f161421c8e00008801f161421c"
            hex"8e000087da3186cf8680008805109afbcb1d562487b1a2bc2ec500008903"
            hex"40a45730235e000088029d80a15f843a2088012eeecb52b54000868bab83"
            hex"b51190872976eb19c136b6876a94d74f430000876220ec9ceea2fa880142"
            hex"427206494000880199f7496099700087dc7f78685be400877e936f5c17ea"
            hex"668758d15e1762800087ef6c03195be00087894d3de2a27000890111fcc7"
            hex"7034d991e887b1a2bc2ec50000880853a0d2313c0000873d4318b6881e00"
            hex"870a4d88ddd940008803ed0220305a78b6872386f26fc10000872386f26f"
            hex"c100008744360899760c6f88479c00a94104000087f195a3c4ba00008720"
            hex"6697785a00008746bbd72822b6118804db7325476300008809fd7af31b21"
            hex"f8008802c4383d6df3d000875bb3a1b5b034008766875a68d3bc0087f461"
            hex"64d412680088074211baa1878000880dda214bea69c44487470de4df8200"
            hex"00880de0b6b3a76400008801f1a4d8434cbf5f8701c6bf52634000872fd3"
            hex"45a633ca6888010b5170d823dbcc831ef5fe88016345785d8a0000832073"
            hex"ea825704821d048802b4e6142055c40088169a2f45f3e5ace0876a94d74f"
            hex"43000087ce230518c88c0087adefff1fca640087ad345e2992cc00880168"
            hex"e909d1d1c800871d5ba7383e855d8711c37937e08000870e0cb529920b00"
            hex"870e0cb529920b00870e0cb529920b008702e238aef418e087043c7f8ef8"
            hex"680087045dda08fe9b80870f1ba04fe8480087077774b2768cc08713a0f5"
            hex"4e62500087033fbb6c0a98c0870310d9e7e31aa08702fafd0129ae408702"
            hex"baf467052bc0872714711487800088014b0fbe2ffd3a388802c68af0bb14"
            hex"0000886124fee993bc000088010150a5573e8ee888035115c53aa7811688"
            hex"c9310ff96afbd9a4877d4d8013bbf630876e7d490483c0008803782dace9"
            hex"d900008802c68af0bb140000880163e4cca7cb9e28887ce66c50e2840000"
            hex"8718de76816d8000880f8b0a10e4700000873c6568f12e80008801634578"
            hex"5d8a0000880c9d6aaf14d4800087470de4df8200008804ba30aebb6aa900"
            hex"87110d9316ec0000880521304d638b5cc088027f7d0bdb920000873fe9cf"
            hex"47826000870d00cdb9a6873c8814d1120d7b16000087b1a2bc2ec5000087"
            hex"b1a2bc2ec500008803782dace9d900008721a36424d7e388874aa41e8474"
            hex"883d8704f4706b9de057876a94d74f43000087114d3d3c0e60008801cdda"
            hex"4faccd000087c2281d6449222f872ffd7455a04000879e3bfaf9ec9741";
        
        uint256 pos = 0;
        uint256 pseudoFloatBytes = 0;
        uint256 decodeCount = 0;

        while (pos < rlpTxValues.length) {
            uint256 value = 0;

            if (rlpTxValues[pos] < 0x80) {
                value = uint256(uint8(rlpTxValues[pos]));
                pos++;
            } else {
                uint8 len = uint8(rlpTxValues[pos]) - 0x80;
                pos++;

                for (uint256 i = 0; i < len; i++) {
                    value <<= 8;
                    value += uint256(uint8(rlpTxValues[pos + i]));
                }

                pos += len;
            }

            checkEncodeAndDecode(value);

            pseudoFloatBytes += PseudoFloat.encode(value).length;
            decodeCount++;
        }

        assertEq(decodeCount, 1175);

        // RLP encodes tx.value in 8.24 bytes on average
        assertEq(100 * rlpTxValues.length / decodeCount, 824);

        // PseudoFloat encodes tx.value in 4.39 bytes on average
        assertEq(100 * pseudoFloatBytes / decodeCount, 439);
        // (It's 4.40 when you do the rounding correctly.)
    }

    function checkEqual(uint256 value, bytes memory encoded) internal {
        (uint256 decodedValue, bytes memory stream) = this.decode(encoded);

        assertEq(decodedValue, value);
        assertEq(stream.length, 0);

        bytes memory encodedValue = PseudoFloat.encode(value);
        assertEq(encodedValue.length, encoded.length);

        for (uint256 i = 0; i < encodedValue.length; i++) {
            assertEq(encodedValue[i], encoded[i]);
        }
    }

    function checkEncodeAndDecode(uint256 value) internal {
        bytes memory encoded = PseudoFloat.encode(value);
        (uint256 decoded, bytes memory stream) = this.decode(encoded);

        assertEq(decoded, value);
        assertEq(stream.length, 0);
    }

    /**
     * This indirection allows making an external call, which converts bytes
     * memory into the required bytes calldata.
     */
    function decode(bytes calldata stream) public pure
        returns (uint256, bytes calldata)
    {
        return PseudoFloat.decode(stream);
    }
}
